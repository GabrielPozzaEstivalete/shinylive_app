[{"name":"app.R","content":"library(shiny)\r\nlibrary(REDCapR)  # pacote para trabalhar com o REDCap\r\nlibrary(readr)\r\nlibrary(ggplot2)\r\nlibrary(RColorBrewer) #graficos em escala de cores\r\nlibrary(scales)\r\nlibrary(plotly)\r\nlibrary(DT)\r\nlibrary(dplyr)\r\nlibrary(tidyverse)\r\nlibrary(writexl)\r\nlibrary(lubridate)\r\nlibrary(shinylive)\r\nlibrary(httpuv)\r\n#install.packages(\"shinylive\")\r\n#install.packages(\"httpuv\")\r\n\r\nui <- fluidPage(\r\n  #navbarPage(\"Inelegíveis com acompanhamento\",\r\n  htmlOutput(\"titulo\"),   tags$head(tags$style(\"#titulo{color: black; font-size: 50px; font-style: bold;}\")),\r\n  htmlOutput(\"Estudo1\"),   tags$head(tags$style(\"#Estudo1{color: black; font-size: 35px; font-style: bold;}\")),\r\n  htmlOutput(\"tab1\"),  tags$head(tags$style(\"#tab1{color: black; font-size: 25px; font-style: bold;}\")),\r\n  DT::dataTableOutput(\"tent1\"),\r\n  htmlOutput(\"tab2\"),  tags$head(tags$style(\"#tab2{color: black; font-size: 25px; font-style: bold;}\")),\r\n  DT::dataTableOutput(\"entr1\"),\r\n  htmlOutput(\"legend\"),  tags$head(tags$style(\"#legend{color: black; font-size: 15px; font-style: bold;}\")),\r\n  \r\n  htmlOutput(\"Estudo2\"),   tags$head(tags$style(\"#Estudo2{color: black; font-size: 35px; font-style: bold;}\")),\r\n  htmlOutput(\"tab3\"),  tags$head(tags$style(\"#tab3{color: black; font-size: 25px; font-style: bold;}\")),\r\n  DT::dataTableOutput(\"tent2\"),\r\n  htmlOutput(\"tab4\"),  tags$head(tags$style(\"#tab4{color: black; font-size: 25px; font-style: bold;}\")),\r\n  DT::dataTableOutput(\"entr2\")\r\n)\r\n\r\n\r\nserver <- function(input, output) {\r\n  \r\n  ########################################################################################################################################\r\n  #######################################################  ESTUDO 1   ####################################################################\r\n  ########################################################################################################################################  \r\n  \r\n  output$titulo <- renderUI(HTML(paste(\"Inelegíveis com acompanhamento\")))\r\n  \r\n  redcap_uri <- \"https://redcap.hmv.org.br/redcap/api/\"\r\n  token <- \"090097F64DBC00AF2C0BFE4D8044AA36\"\r\n  \r\n  dados_REDCap <- redcap_read_oneshot(\r\n    redcap_uri = redcap_uri, \r\n    token =  token,\r\n    export_data_access_groups = TRUE\r\n  )$data\r\n  dados <- dados_REDCap \r\n  \r\n  \r\n  dados <- dados %>%\r\n    filter(redcap_data_access_group != \"\")\r\n  \r\n  Elegibilidade <- dados %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>% \r\n    select(record_id,redcap_data_access_group,data_aval:elegibilidade_complete)\r\n  \r\n  LB <- dados %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>% \r\n    select(record_id,data_intern:linha_de_base_complete)\r\n  \r\n  Prev <- dados %>%\r\n    filter(redcap_event_name == \"dados_previos_arm_1\") %>%\r\n    select(record_id, aplic_eq5d3l_previo:dados_prvios_complete)\r\n  \r\n  \r\n  eq5prev <- Prev %>%\r\n    select(record_id, aplic_eq5d3l_previo:eq5d3l_respondente, dados_prvios_complete)\r\n  \r\n  lawtonprev <- Prev %>%\r\n    select(record_id, aplic_lawton_previo:lawton_score_previo, dados_prvios_complete)\r\n  \r\n  Seg_3M <-dados %>% \r\n    filter(redcap_event_name == \"3_meses_arm_1\") %>% \r\n    select(record_id,dta_tent_t1:escala_do_impacto_do_evento_resumida_ies6_complete)\r\n  \r\n  names(Seg_3M) <- stringr::str_c(\"Seg_3M_\",names(Seg_3M))\r\n  \r\n  Seg_6M <-dados %>% \r\n    filter(redcap_event_name == \"6_meses_arm_1\") %>% \r\n    select(record_id,dta_tent_t1:escala_do_impacto_do_evento_resumida_ies6_complete)\r\n  \r\n  names(Seg_6M) <- stringr::str_c(\"Seg_6M_\",names(Seg_6M))\r\n  \r\n  Seg_9M <-dados %>% \r\n    filter(redcap_event_name == \"9_meses_arm_1\") %>% \r\n    select(record_id,dta_tent_t1:escala_do_impacto_do_evento_resumida_ies6_complete)\r\n  \r\n  names(Seg_9M) <- stringr::str_c(\"Seg_9M_\",names(Seg_9M))\r\n  \r\n  Seg_12M <-dados %>% \r\n    filter(redcap_event_name == \"12_meses_arm_1\") %>% \r\n    select(record_id,dta_tent_t1:escala_do_impacto_do_evento_resumida_ies6_complete)\r\n  \r\n  names(Seg_12M) <- stringr::str_c(\"Seg_12M_\",names(Seg_12M))\r\n  \r\n  dados_Eleg_LB <- left_join(Elegibilidade,LB,\r\n                             by=c(\"record_id\"=\"record_id\"))\r\n  \r\n  dados_Eleg_LB_Prev <- left_join(dados_Eleg_LB, Prev,\r\n                                  by=c(\"record_id\"=\"record_id\"))\r\n  \r\n  dados_Eleg_LB_3M <- left_join(dados_Eleg_LB_Prev,Seg_3M,\r\n                                by=c(\"record_id\"=\"Seg_3M_record_id\"))\r\n  \r\n  dados_Eleg_LB_3M_6M <- left_join(dados_Eleg_LB_3M,Seg_6M,\r\n                                   by=c(\"record_id\"=\"Seg_6M_record_id\"))\r\n  \r\n  dados_Eleg_LB_3M_6M_9M <- left_join(dados_Eleg_LB_3M_6M,Seg_9M,\r\n                                      by=c(\"record_id\"=\"Seg_9M_record_id\"))\r\n  \r\n  dados_Eleg_LB_3M_6M_9M_12M <- left_join(dados_Eleg_LB_3M_6M_9M,Seg_12M,\r\n                                          by=c(\"record_id\"=\"Seg_12M_record_id\"))\r\n  \r\n  dados <- dados_Eleg_LB_3M_6M_9M_12M\r\n  \r\n  ID_CENTRO <- c(\"3525\",\"3661\" ,\"3597\",\"3663\" ,\"3596\" ,\"3704\" , \"3599\" ,\"3702\",\"3798\",\"3802\",\"\")\r\n  \r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hmv\"] <- \"HMV\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hospital_dr_leo_or\"] <- \"Leo Orsi\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hospital_ernesto_d\"] <- \"HED\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hospital_emydio_ge\"] <- \"HEG - BH\"\r\n  #dados$redcap_data_access_group[dados$redcap_data_access_group == \"hospital_enseada_p\"] <- \"Enseada\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"cemetron\"] <- \"CEMETRON\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hospital_alemo_osw\"] <- \"HAOC\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"iorizonti\"] <- \"Orizonti\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"inst_p_hosp_corao\"] <- \"HCOR\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hosp_met_dr_celio\"] <- \"Metropolitano\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hospital_beneficnc\"] <- \"Beneficência\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hosp_clnicas_ufmg\"] <- \"UFMG\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hospital_r_nelson\"] <- \"Hospitalize\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hosp_univ_est_de_p\"] <- \"Ponta Grossa\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"associao_hospitala\"] <- \"Vila Nova\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hcmgs__hospital_do\"] <- \"HCMGS\"\r\n  dados$redcap_data_access_group[dados$redcap_data_access_group == \"hcpa__hospital_de\"] <- \"HCPA\"\r\n  \r\n  dados$redcap_data_access_group <- factor(dados$redcap_data_access_group, levels = c(\"HMV\",\"Leo Orsi\",\"HEG - BH\" ,\"HED\" ,\"CEMETRON\" , \"HAOC\",\"Orizonti\",\r\n                                                                                      \"HCOR\",\"Metropolitano\",\"Beneficência\",\"UFMG\",\r\n                                                                                      \"Hospitalize\",\"Ponta Grossa\",\"Vila Nova\",\"HCMGS\",\"HCPA\"))\r\n  \r\n  #Criando o critério de elegibilidade \r\n  dados$eleg <- ifelse(dados$elegibilidade == 1 & !(is.na(dados$dta_alta_atual)), 1, 0) \r\n  \r\n  dados_ineleg <- dados %>% \r\n    filter(eleg != 1)\r\n  \r\n  dados_ineleg$mot_ineleg <- case_when(dados_ineleg$sintomas == 0 ~ \"1\",\r\n                                       dados_ineleg$pcr == 0 ~\"2\",\r\n                                       dados_ineleg$hosp_sup48 == 0 ~\"3\",\r\n                                       dados_ineleg$sem_consent == 0 ~\"4\",\r\n                                       dados_ineleg$partic_incluido == 1 ~\"5\",\r\n                                       dados_ineleg$contato_indisp == 1 ~\"6\")\r\n  \r\n  dados_com_tent <- dados_ineleg %>%\r\n    filter(!is.na(dados_ineleg$Seg_3M_dta_tent_t1) | !is.na(dados_ineleg$Seg_6M_dta_tent_t1) | !is.na(dados_ineleg$Seg_9M_dta_tent_t1) | \r\n             !is.na(dados_ineleg$Seg_12M_dta_tent_t1))\r\n  \r\n  dados_c_entrevist <- dados_ineleg %>%\r\n    filter(dados_ineleg$Seg_3M_entrevista == \"1\"| dados_ineleg$Seg_6M_entrevista == \"1\"| dados_ineleg$Seg_9M_entrevista == \"1\"| \r\n             dados_ineleg$Seg_12M_entrevista == \"1\")\r\n  \r\n  ids_tent <- data.frame(dados_com_tent$record_id, dados_com_tent$mot_ineleg)\r\n  colnames(ids_tent) <- c(\"ID's\", \"Motivo inelegibilidade\")\r\n  \r\n  ids_entr <- data.frame(dados_c_entrevist$record_id, dados_c_entrevist$mot_ineleg)\r\n  colnames(ids_entr) <- c(\"ID's\", \"Motivo inelegibilidade\")\r\n  \r\n  \r\n  output$Estudo1 <- renderUI(HTML(paste(\"<br> Estudo 1\")))\r\n  output$tab1 <- renderUI(HTML(paste(\"ID's inelegíveis em que houve tentativa de contato\")))\r\n  output$tent1 <- DT::renderDataTable(DT::datatable(ids_tent, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:2)), paging = FALSE, dom = 't')))\r\n  \r\n  output$tab2 <- renderUI(HTML(paste(\"ID's inelegíveis em que houve entrevista\")))\r\n  output$entr1 <- DT::renderDataTable(DT::datatable(ids_entr, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:2)), paging = FALSE, dom = 't')))\r\n  \r\n  output$legend <- renderUI(HTML(paste(\"\", \"Legenda\", \"1 - Sem sintomas\", \"2 - PCR negativo\", \"3 - Necessidade de hospitalização\", \"4 - Sem consentimento\", \"5 - Já incluído\", \"6 - Sem contato\", sep=\"<br/>\")))\r\n  \r\n  ########################################################################################################################################\r\n  #######################################################  ESTUDO 2   ####################################################################\r\n  ######################################################################################################################################## \r\n  \r\n  redcap_uri2 <- \"https://redcap.hmv.org.br/redcap/api/\"\r\n  token2 <- \"2E41ACB3834F72D69510EB3610C4D61D\"\r\n  \r\n  dados_REDCap2 <- redcap_read_oneshot(\r\n    redcap_uri = redcap_uri2, \r\n    token =  token2,\r\n    export_data_access_groups = TRUE\r\n  )$data\r\n  dados2 <- dados_REDCap2\r\n  \r\n  \r\n  \r\n  dados2 <- dados2 %>%\r\n    filter(redcap_data_access_group != \"\")   ###Removendo o ID que é usado como teste\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  Elegibilidade2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>% \r\n    select(record_id,data_aval:elegibilidade_complete)\r\n  \r\n  Prev2 <- dados2 %>%\r\n    filter(redcap_event_name == \"dados_prvios_arm_1\") %>%\r\n    select(record_id, aplic_eq5d3l_previo:dados_prvios_complete)\r\n  \r\n  eq5prev2 <- Prev2 %>%\r\n    select(record_id, aplic_eq5d3l_previo:eq5d3l_respondente, dados_prvios_complete)\r\n  \r\n  lawtonprev2 <- Prev2 %>%\r\n    select(record_id, aplic_lawton_previo:dados_prvios_complete)\r\n  \r\n  #####termos de consentimento online\r\n  \r\n  etcle_HMV2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>% \r\n    filter(redcap_data_access_group == \"hmv\") %>% \r\n    select(record_id,aceite:etcle_complete) \r\n  \r\n  etcle_orizonti2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>% \r\n    filter(redcap_data_access_group == \"iorizonti\") %>% \r\n    select(record_id,aceite_orizonti:etcle_orizonti_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_orizonti\",\r\n           \"data_assin\"        = \"data_assin_orizonti\",\r\n           \"nome\"              = \"nome_orizonti\",\r\n           \"assinatura_partic\" = \"assinatura_partic_orizonti\" ,\r\n           \"etcle_complete\"    = \"etcle_orizonti_complete\" )\r\n  \r\n  etcle_HAOC2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>%\r\n    filter(redcap_data_access_group == \"hospital_alemo_osw\") %>% \r\n    select(record_id,aceite_haoc:etcle_haoc_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_haoc\",\r\n           \"data_assin\"        = \"data_assin_haoc\",\r\n           \"nome\"              = \"nome_haoc\",\r\n           \"assinatura_partic\" = \"assinatura_partic_haoc\" ,\r\n           \"etcle_complete\"    = \"etcle_haoc_complete\" )\r\n  \r\n  etcle_ribeirao_preto2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>%\r\n    filter(redcap_data_access_group == \"hosp_cln_ribeiro_p\") %>% \r\n    select(record_id,aceite_rp:etcle_ribeiro_preto_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_rp\",\r\n           \"data_assin\"        = \"data_assin_rp\",\r\n           \"nome\"              = \"nome_rp\",\r\n           \"assinatura_partic\" = \"assinatura_partic_rp\" ,\r\n           \"etcle_complete\"    = \"etcle_ribeiro_preto_complete\" )\r\n  \r\n  etcle_metropolitano2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>%\r\n    filter(redcap_data_access_group == \"hosp_met_dr_celio\") %>% \r\n    select(record_id,aceite_metropolitano:etcle_metropolitano_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_metropolitano\",\r\n           \"data_assin\"        = \"data_assin_metropolitano\",\r\n           \"nome\"              = \"nome_metropolitano\",\r\n           \"assinatura_partic\" = \"assinatura_partic_metropolitano\" ,\r\n           \"etcle_complete\"    = \"etcle_metropolitano_complete\" )\r\n  \r\n  \r\n  etcle_heg2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>%\r\n    filter(redcap_data_access_group == \"hospital_emydio_ge\") %>% \r\n    select(record_id,aceite_heg:etcle_heg_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_heg\",\r\n           \"data_assin\"        = \"data_assin_heg\",\r\n           \"nome\"              = \"nome_heg\",\r\n           \"assinatura_partic\" = \"assinatura_partic_heg\" ,\r\n           \"etcle_complete\"    = \"etcle_heg_complete\")\r\n  \r\n  etcle_sp2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>%\r\n    filter(redcap_data_access_group == \"hospital_santa_pau\") %>% \r\n    select(record_id,aceite_sp:etcle_santa_paula_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_sp\",\r\n           \"data_assin\"        = \"data_assin_sp\",\r\n           \"nome\"              = \"nome_sp\",\r\n           \"assinatura_partic\" = \"assinatura_partic_sp\" ,\r\n           \"etcle_complete\"    = \"etcle_santa_paula_complete\")\r\n  \r\n  etcle_hcor2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>%\r\n    filter(redcap_data_access_group == \"hcor\") %>% \r\n    select(record_id,aceite_hcor:etcle_hcor_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_hcor\",\r\n           \"data_assin\"        = \"data_assin_hcor\",\r\n           \"nome\"              = \"nome_hcor\",\r\n           \"assinatura_partic\" = \"assinatura_partic_hcor\" ,\r\n           \"etcle_complete\"    = \"etcle_hcor_complete\")\r\n  \r\n  etcle_sante2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>%\r\n    filter(redcap_data_access_group == \"c_silvestre_sant\") %>% \r\n    select(record_id,aceite_sante:etcle_silvestre_sant_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_sante\",\r\n           \"data_assin\"        = \"data_assin_sante\",\r\n           \"nome\"              = \"nome_sante\",\r\n           \"assinatura_partic\" = \"assinatura_partic_sante\" ,\r\n           \"etcle_complete\"    = \"etcle_silvestre_sant_complete\")\r\n  \r\n  etcle_nelson2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>%\r\n    filter(redcap_data_access_group == \"hospital_r_nelson\") %>% \r\n    select(record_id,aceite_nelson:etcle_nelson_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_nelson\",\r\n           \"data_assin\"        = \"data_assin_nelson\",\r\n           \"nome\"              = \"nome_nelson\",\r\n           \"assinatura_partic\" = \"assinatura_partic_nelson\" ,\r\n           \"etcle_complete\"    = \"etcle_nelson_complete\")\r\n  \r\n  etcle_enseada2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>%\r\n    filter(redcap_data_access_group == \"hospital_enseada_p\") %>% \r\n    select(record_id,aceite_enseada:etcle_enseada_prime_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_enseada\",\r\n           \"data_assin\"        = \"data_assin_enseada\",\r\n           \"nome\"              = \"nome_enseada\",\r\n           \"assinatura_partic\" = \"assinatura_partic_enseada\" ,\r\n           \"etcle_complete\"    = \"etcle_enseada_prime_complete\")\r\n  \r\n  etcle_uepg2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>%\r\n    filter(redcap_data_access_group == \"hosp_univ_est_de_p\") %>% \r\n    select(record_id,aceite_uepg:etcle_uepg_complete) %>% \r\n    rename(\"aceite\"            = \"aceite_uepg\",\r\n           \"data_assin\"        = \"data_assin_uepg\",\r\n           \"nome\"              = \"nome_uepg\",\r\n           \"assinatura_partic\" = \"assinatura_partic_uepg\" ,\r\n           \"etcle_complete\"    = \"etcle_uepg_complete\")\r\n  \r\n  etcle2 <- rbind(etcle_HMV2,etcle_orizonti2,etcle_HAOC2,etcle_ribeirao_preto2,etcle_metropolitano2,etcle_heg2,etcle_sp2,\r\n                  etcle_hcor2,etcle_sante2,etcle_nelson2,etcle_enseada2,etcle_uepg2)\r\n  \r\n  Eleg2 <- Elegibilidade2 %>% \r\n    left_join(etcle2, by = \"record_id\") \r\n  \r\n  ########### \r\n  \r\n  LB2 <- dados2 %>% \r\n    filter(redcap_event_name == \"dados_basais_arm_1\") %>% \r\n    select(record_id,redcap_data_access_group,data_us:linha_de_base_complete)\r\n  \r\n  ########### Seguimento2 de 1 meses\r\n  \r\n  Seg_1M2 <-dados2 %>% \r\n    filter(redcap_event_name == \"30_dias_arm_1\") %>% \r\n    select(record_id,dta_tent_t1_30d:seguimento_30_dias_complete)\r\n  \r\n  \r\n  ########### Seguimento de 3 meses \r\n  Seg_3M2 <-dados2 %>% \r\n    filter(redcap_event_name == \"3_meses_arm_1\") %>% \r\n    select(record_id,redcap_data_access_group,dta_tent_t1:escala_do_impacto_do_evento_resumida_ies6_complete)\r\n  \r\n  names(Seg_3M2) <- stringr::str_c(\"Seg_3M_\",names(Seg_3M2))\r\n  \r\n  \r\n  \r\n  Seg_6M2 <-dados2 %>% \r\n    filter(redcap_event_name == \"6_meses_arm_1\") %>% \r\n    select(record_id,dta_tent_t1:escala_do_impacto_do_evento_resumida_ies6_complete)\r\n  \r\n  names(Seg_6M2) <- stringr::str_c(\"Seg_6M_\",names(Seg_6M2))\r\n  \r\n  Seg_9M2 <-dados2 %>% \r\n    filter(redcap_event_name == \"9_meses_arm_1\") %>% \r\n    select(record_id,dta_tent_t1:escala_do_impacto_do_evento_resumida_ies6_complete)\r\n  \r\n  names(Seg_9M2) <- stringr::str_c(\"Seg_9M_\",names(Seg_9M2))\r\n  \r\n  Seg_12M2 <-dados2 %>% \r\n    filter(redcap_event_name == \"12_meses_arm_1\") %>% \r\n    select(record_id,dta_tent_t1:escala_do_impacto_do_evento_resumida_ies6_complete)\r\n  \r\n  names(Seg_12M2) <- stringr::str_c(\"Seg_12M_\",names(Seg_12M2))\r\n  \r\n  ########### Juntando as bases de dados\r\n  \r\n  dados_Eleg_LB2 <- left_join(Eleg2,LB2,\r\n                              by=c(\"record_id\"=\"record_id\"))\r\n  \r\n  dados_Eleg_LB_Prev2 <- left_join(dados_Eleg_LB2, Prev2,\r\n                                   by=c(\"record_id\"=\"record_id\"))\r\n  \r\n  dados_Eleg_LB_1M2 <- left_join(dados_Eleg_LB_Prev2,Seg_1M2,\r\n                                 by=c(\"record_id\"=\"record_id\"))\r\n  \r\n  dados_Eleg_LB_1M_3M2 <- left_join(dados_Eleg_LB_1M2,Seg_3M2,\r\n                                    by=c(\"record_id\"=\"Seg_3M_record_id\"))\r\n  \r\n  dados_Eleg_LB_1M_3M_6M2 <- left_join(dados_Eleg_LB_1M_3M2,Seg_6M2,\r\n                                       by=c(\"record_id\"=\"Seg_6M_record_id\"))\r\n  \r\n  dados_Eleg_LB_1M_3M_6M_9M2 <- left_join(dados_Eleg_LB_1M_3M_6M2,Seg_9M2,\r\n                                          by=c(\"record_id\"=\"Seg_9M_record_id\"))\r\n  \r\n  dados_Eleg_LB_1M_3M_6M_9M_12M2 <- left_join(dados_Eleg_LB_1M_3M_6M_9M2,Seg_12M2,\r\n                                              by=c(\"record_id\"=\"Seg_12M_record_id\"))\r\n  \r\n  dados2 <- dados_Eleg_LB_1M_3M_6M_9M_12M2\r\n  \r\n  \r\n  \r\n  ID_CENTRO2 <- c(\"3529\",\"3662\" ,\"3689\",\"3699\" ,\"3705\",\"3600\",\"3908\",\"3799\",\"3914\",\"\")\r\n  \r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"hmv\"] <- \"HMV\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"hospital_dr_leo_or\"] <- \"Leo Orsi\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"hosp_cln_ribeiro_p\"] <- \"Ribeirão Preto\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"procardio\"] <- \"PROCARDIO\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"hospital_alemo_osw\"] <- \"HAOC\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"iorizonti\"] <- \"Orizonti\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"c_silvestre_sant\"] <- \"Silvestre Santé\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"hosp_met_dr_celio\"] <- \"Metropolitano\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"hcor\"] <- \"HCOR\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"hosp_univ_est_de_p\"] <- \"Ponta Grossa\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"hospital_santa_pau\"] <- \"Santa Paula\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"hospital_enseada_p\"] <- \"Enseada Prime\"\r\n  dados2$redcap_data_access_group[dados2$redcap_data_access_group == \"associao_hospitala\"] <- \"Vila Nova\"\r\n  \r\n  \r\n  dados2$redcap_data_access_group <- factor(dados2$redcap_data_access_group, levels = c(\"HMV\",\"Leo Orsi\", \"Ribeirão Preto\", \r\n                                                                                        \"PROCARDIO\", \"HAOC\", \"Orizonti\",\r\n                                                                                        \"Silvestre Santé\",\"Metropolitano\",\"HCOR\",\r\n                                                                                        \"Ponta Grossa\",\"Santa Paula\",\r\n                                                                                        \"Enseada Prime\",\"Vila Nova\"))\r\n  \r\n  \r\n  \r\n  #Criando o critério de elegibilidade \r\n  dados2$eleg <- ifelse(dados2$elegibilidade == 1 & dados2$particip_consent == 1, 1, 0)\r\n  \r\n  dados2_ineleg <- dados2 %>% \r\n    filter(eleg != 1)\r\n  \r\n  dados2_ineleg$mot_ineleg <- case_when(dados2_ineleg$sintomas == 0 ~ \"1\",\r\n                                        dados2_ineleg$pcr == 0 ~\"2\",\r\n                                        dados2_ineleg$ambu_s_hosp == 0 ~\"3\",\r\n                                        dados2_ineleg$sem_consent == 0 ~\"4\",\r\n                                        dados2_ineleg$partic_incluido == 1 ~\"5\",\r\n                                        dados2_ineleg$contato_indisp == 1 ~\"6\")\r\n  \r\n  dados2_com_tent <- dados2_ineleg %>%\r\n    filter(!is.na(dados2_ineleg$dta_tent_t1_30d) | !is.na(dados2_ineleg$Seg_3M_dta_tent_t1) | !is.na(dados2_ineleg$Seg_6M_dta_tent_t1) | !is.na(dados2_ineleg$Seg_9M_dta_tent_t1) | \r\n             !is.na(dados2_ineleg$Seg_12M_dta_tent_t1))\r\n  \r\n  dados2_c_entrevist <- dados2_ineleg %>%\r\n    filter(dados2_ineleg$entrevista_30d == \"1\" | dados2_ineleg$Seg_3M_entrevista == \"1\"| dados2_ineleg$Seg_6M_entrevista == \"1\"| dados2_ineleg$Seg_9M_entrevista == \"1\"| \r\n             dados2_ineleg$Seg_12M_entrevista == \"1\")\r\n  \r\n  ids_tent_2 <- data.frame(dados2_com_tent$record_id, dados2_com_tent$mot_ineleg)\r\n  colnames(ids_tent_2) <- c(\"ID's\", \"Motivo inelegibilidade\")\r\n  \r\n  ids_entr_2 <- data.frame(dados2_c_entrevist$record_id, dados2_c_entrevist$mot_ineleg)\r\n  colnames(ids_entr_2) <- c(\"ID's\", \"Motivo inelegibilidade\")\r\n  \r\n  output$Estudo2 <- renderUI(HTML(paste(\"<br> Estudo 2\")))\r\n  \r\n  output$tab3 <- renderUI(HTML(paste(\"ID's inelegíveis em que houve tentativa de contato\")))\r\n  output$tent2 <- DT::renderDataTable(DT::datatable(ids_tent_2, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:2)), paging = FALSE, dom = 't')))\r\n  \r\n  output$tab4 <- renderUI(HTML(paste(\"ID's inelegíveis em que houve entrevista\")))\r\n  output$entr2 <- DT::renderDataTable(DT::datatable(ids_entr_2, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:2)), paging = FALSE, dom = 't')))\r\n}\r\n\r\n\r\nshinyApp(ui = ui, server = server)\r\n","type":"text"},{"name":"mtcars_demo.Rproj","content":"Version: 1.0\r\n\r\nRestoreWorkspace: Default\r\nSaveWorkspace: Default\r\nAlwaysSaveHistory: Default\r\n\r\nEnableCodeIndexing: Yes\r\nUseSpacesForTab: Yes\r\nNumSpacesForTab: 2\r\nEncoding: UTF-8\r\n\r\nRnwWeave: Sweave\r\nLaTeX: pdfLaTeX\r\n","type":"text"}]
